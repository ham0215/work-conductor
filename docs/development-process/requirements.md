# AI自律型開発プロセス エージェント仕様書

## 概要
人間（プロジェクトマネージャー: PM）は「実行可能な仕様（Executable Spec）」と「完了基準（ガードレール）」のみを定義します。開発、設計レビュー、そして厳格な品質保証プロセスは、人間がコードを見ることなく、AIエージェント群によって自律的に完結します。

## エージェント構成図（参照用）
*（最新のフロー図 image_5.png に準拠）*

---

## 1. 上流設計・全体管理チーム

PMの意図を技術仕様に落とし込み、実装前に論理的な不備を排除するチームです。

### 1.1. アーキテクトAI (Architect AI)
* **役割:** システム全体の設計とタスク分解の責任者。
* **入力:** PMからの要件定義書（Executable Spec）。
* **主な振る舞い:**
    * 要求を満たすための技術スタック選定、アーキテクチャ設計を行う。
    * 開発者が実装可能な粒度までタスクを分解する。
    * 詳細な設計ドキュメントを作成する。
* **出力:** 設計ドキュメント、分解されたタスクリスト。

### 1.2. 設計ドキュメントレビュアー (Design Document Reviewer)
* **役割:** 設計段階での品質ゲートキーパー。曖昧さの排除を担当。
* **入力:** アーキテクトAIが作成した設計ドキュメント。
* **主な振る舞い:**
    * 設計書内の曖昧な記述、解釈が複数に分かれる表現を指摘する。
    * コンポーネント間の整合性や、要件の記載漏れがないかをチェックする。
* **出力:** 設計への指摘事項リスト（修正指示）。

### 1.3. 設計レベルセキュリティレビュアー (Design-Level Security Reviewer)
* **役割:** 設計段階での脅威モデリング担当（シフトレフトセキュリティ）。
* **入力:** 設計ドキュメント。
* **主な振る舞い:**
    * 実装コードではなく、アーキテクチャ図やデータフロー図を分析する。
    * 潜在的なセキュリティリスク（例: 認証フローの不備、データの暗号化漏れ）を洗い出す。
* **出力:** 脅威モデリングレポートと修正指示。

---

## 2. 実装チーム（作る側）

実際に動作するコードを作成し、ガードレールからの指摘に対応して修正ループを回すチームです。

### 2.1. 開発者AIチーム (Developer AI Team)
* **役割:** 自律的なコーディングの実働部隊。
* **入力:** 分解されたタスク、設計ドキュメント、検証ガードレールからの修正指示。
* **主な振る舞い:**
    * 割り当てられたタスクのコードを実装する。
    * 各種専門家エージェントやガードレールからの指摘事項に基づき、コードを修正する。
* **出力:** ソースコード、単体テストコード。

### 2.2. プログラム言語・フレームワークの専門家 (Language/Framework Expert)
* **役割:** 開発者AIに対する技術顧問・アドバイザー。
* **入力:** 開発者AIが記述したソースコード。
* **主な振る舞い:**
    * 特定言語・フレームワークの最新のベストプラクティスに準拠しているかチェックする。
    * 非推奨な機能の使用や、パフォーマンスに悪影響を与える書き方を指摘する。
* **出力:** コード改善提案、リファクタリング指示。

---

## 3. 検証ガードレール（検査する側 - 自動化されたゲートキーパー）

開発者AIチームが作成した成果物が通過しなければならない、厳格かつ多層的なチェックゲート群です。人間によるレビューの代わりとなります。

### 【部門A：受入テスト・仕様適合性】

#### 3.1. 受け入れテスト作成エージェント (Acceptance Test Creator)
* **役割:** 要件からテストシナリオを生成する。「何をもって完了とするか」を定義。
* **入力:** PMからの要件定義書。
* **出力:** 受入テストシナリオ（Gherkin記法やE2Eテストスクリプト形式）。

#### 3.2. 受け入れテストレビュアー (Acceptance Test Reviewer)
* **役割:** テストシナリオ自体の品質を保証する監査役。
* **入力:** 要件定義書、および作成された受入テストシナリオ。
* **主な振る舞い:**
    * テストシナリオが要件を正しく網羅しているか、解釈違いがないかを検証する。「AIが作ったテストをAIがチェックする」構造。
* **出力:** テストシナリオへの修正指示または承認。

### 【部門B：単体/結合テスト・網羅性】

#### 3.3. ホワイトボックステストレビュアー (White-Box Test Reviewer)
* **役割:** コード内部構造に基づくテスト品質チェック。
* **入力:** 実装コードとテストコード。
* **主な振る舞い:**
    * コードの複雑な分岐条件（if/else, switchなど）が全てテストされているかを確認する。
    * 境界値分析や異常系テストが不足していないか指摘する。

#### 3.4. ブラックボックステストレビュアー (Black-Box Test Reviewer)
* **役割:** 設計仕様に基づくテスト品質チェック（トレーサビリティ）。
* **入力:** 設計ドキュメントとテストコード一覧。
* **主な振る舞い:**
    * 設計書に記載された全ての機能要件に対して、対応するテストケースが存在するかを確認する。

#### 3.5. カバレッジ監視エージェント (Coverage Monitor Agent)
* **役割:** 定量的なテスト品質の門番。
* **入力:** テスト実行によるカバレッジレポート。
* **主な振る舞い:**
    * PMが設定した目標カバレッジ（例: 100%）を下回っていないか機械的に判定する。
    * 前回のビルド時よりカバレッジが低下していないか（リグレッション）を監視する。

### 【部門C：セキュリティ・常識】

#### 3.6. ホワイトボックスセキュリティエージェント (SAST Agent)
* **役割:** コード静的解析による脆弱性検知。
* **入力:** ソースコード。
* **主な振る舞い:**
    * SASTツールを用いてコードをスキャンし、SQLインジェクションやXSSなどの典型的な脆弱性パターンを検出する。
    * 安全でないライブラリの使用をチェックする。

#### 3.7. ブラックボックスセキュリティ実行エージェント (DAST Agent)
* **役割:** 擬似攻撃による動的脆弱性診断。
* **入力:** 稼働中のアプリケーション（ステージング環境など）。
* **主な振る舞い:**
    * DASTツールを用いて外部からアプリケーションにアクセスし、脆弱性をスキャンする。

#### 3.8. 常識エージェント (Common Sense / UX & Safety Agent)
* **役割:** 「仕様書にないが、やってはいけないこと/やるべきこと」のチェック。
* **入力:** 設計書、画面UI、アプリケーションの振る舞い。
* **主な振る舞い:**
    * 人間として自然な使い勝手（UX）になっているか。
    * 危険な操作（データ削除など）に対する確認フローが抜けていないかなど、常識的な観点での欠陥を指摘する。

---

## 4. 最終検証チーム

全てのガードレールを通過した「合格候補品」に対し、最終的な動作確認を行うチームです。

### 4.1. 受け入れテスト実行エージェント (E2E Test Runner)
* **役割:** 最終的な品質証明の発行者。
* **入力:** レビュー済みの受入テストシナリオ、全ガードレールを通過したアプリケーション。
* **主な振る舞い:**
    * 実際のブラウザやデバイスシミュレータを操作し、ユーザー視点でのE2Eテストを自動実行する。
* **出力:** テスト実行結果レポート（合格証明書）。これをもってPMへの納品物となる。
